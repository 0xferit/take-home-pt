<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TakeHome PT – Structure Optimization Planner for Portugal Professionals</title>
    <meta name="description" content="Optimize your business structure in Portugal. Compare take-home income across Freelancer (Simplified), Freelancer (Organized), and LDA to maximize your net income.">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="container">
                <h1 class="header__title">TakeHome PT</h1>
                <p class="header__subtitle">Find the business structure that maximizes your take-home income in Portugal</p>
                <p class="header__tagline">Compare Freelancer (Simplified & Organized) vs Single-Member Company (LDA)</p>
            </div>
        </header>

        <nav class="tabs">
            <div class="container">
                <button class="tab active" data-tab="setup">Setup</button>
                <button class="tab" data-tab="income">Income</button>
                <button class="tab" data-tab="expenses">Expenses</button>
                <button class="tab" data-tab="deductions">Deductions</button>
                <button class="tab" data-tab="results">Results</button>
                <button class="tab" data-tab="methodology">Methodology</button>
            </div>
        </nav>

        <main class="main">
            <div class="container">
                
                <!-- Setup Tab -->
                <section id="setup" class="tab-content active">
                    <h2>Your Profile & Tax Status</h2>
                    
                    <div class="form-group">
                        <label>Activity Type <span class="required">*</span></label>
                        <p class="help-text" style="margin-bottom: var(--space-3);">Select your activity type first. This determines NHR eligibility and tax coefficient.</p>
                        <div class="radio-group">
                            <label class="radio-card" data-activity-option="services_high_value">
                                <input type="radio" name="activity-profile" value="services_high_value" checked>
                                <div class="radio-card__content">
                                    <strong>High-value professions (Article 151)</strong>
                                    <span>75% taxable, 25% deemed expenses — NHR 20% eligible</span>
                                </div>
                            </label>
                            <label class="radio-card" data-activity-option="services_general">
                                <input type="radio" name="activity-profile" value="services_general">
                                <div class="radio-card__content">
                                    <strong>General professional services</strong>
                                    <span>35% taxable, 65% deemed expenses — NHR not applicable</span>
                                </div>
                            </label>
                        </div>
                        <details class="details">
                            <summary>What are high-value professions?</summary>
                            <p>High-value professions include software development, consulting, design, and other technical services listed in Article 151 of the Portuguese tax code.</p>
                            <p><strong>CAE Codes:</strong> <span id="activity-summary-codes"></span></p>
                        </details>
                    </div>

                    <div class="form-group">
                        <label for="nhr-status">NHR / Tax Status</label>
                        <select id="nhr-status" class="input">
                            <option value="standard">Standard progressive rates</option>
                            <option value="original_nhr" disabled>Original NHR (20% flat rate)</option>
                            <option value="nhr_2_ifici" disabled>NHR 2.0 / IFICI (20% flat rate)</option>
                        </select>
                        <p id="nhr-status-note" class="help-text">Select your activity type above to see if NHR 20% flat rate is available.</p>
                    </div>

                    <div class="form-group">
                        <label for="activity-code">CAE Activity Code (optional)</label>
                        <input 
                            type="text" 
                            id="activity-code" 
                            class="input" 
                            list="activity-code-options"
                            placeholder="e.g., 62010"
                            maxlength="5">
                        <datalist id="activity-code-options"></datalist>
                        <p class="help-text">Enter your 5-digit CAE code to auto-select the correct activity type.</p>
                    </div>

                    <details class="details">
                        <summary>First-year benefits & age-based exemptions</summary>
                        <div class="checkbox-group">
                            <label class="checkbox">
                                <input type="checkbox" id="firstyear-ss-exempt">
                                <span>Social Security 12-month exemption</span>
                            </label>
                            <p class="help-text" style="margin-left: 2rem; margin-top: -0.5rem;">
                                First 12 months of activity (rolling period from activity start date). Applies to new self-employed professionals.
                            </p>
                            
                            <label class="checkbox">
                                <input type="checkbox" id="firstyear-irs-50">
                                <span>50% IRS coefficient reduction</span>
                            </label>
                            <p class="help-text" style="margin-left: 2rem; margin-top: -0.5rem;">
                                First <strong>calendar year</strong> of activity only. Reduces the activity coefficient (75% → 37.5% or 35% → 17.5%).
                            </p>
                            
                            <label class="checkbox">
                                <input type="checkbox" id="irs-jovem">
                                <span>IRS Jovem (Youth Tax Benefit)</span>
                            </label>
                            <p class="help-text" style="margin-left: 2rem; margin-top: -0.5rem;">
                                For residents under 35 with completed higher education. Progressive income tax exemption over 5-10 years. <strong>Can combine with NHR/IFICI.</strong>
                            </p>
                        </div>
                        <div id="irs-jovem-year-selector" class="form-group" style="display: none; margin-top: var(--space-4);">
                            <label for="irs-jovem-year">IRS Jovem Year</label>
                            <select id="irs-jovem-year" class="input">
                                <option value="1">Year 1 (100% exemption) — First tax year after completing degree</option>
                                <option value="2">Year 2 (75% exemption)</option>
                                <option value="3">Year 3 (50% exemption)</option>
                                <option value="4">Year 4 (50% exemption)</option>
                                <option value="5">Year 5 (25% exemption)</option>
                                <option value="6">Year 6+ (no exemption) — Benefit expired or not using</option>
                            </select>
                            <p class="help-text">
                                <strong>Eligibility:</strong> Under 35 years old, completed higher education (bachelor's or higher), Portuguese tax resident.<br>
                                <strong>Year counting:</strong> Year 1 = first tax year after completing your degree (not first job year).<br>
                                <strong>Example:</strong> Graduated in 2023, started working 2024 → 2024 is Year 1.
                            </p>
                        </div>
                    </details>
                </section>

                <!-- Income Tab -->
                <section id="income" class="tab-content">
                    <h2>Your Income</h2>
                    
                    <div class="form-group">
                        <label for="gross-income">Annual Gross Income from Services</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="gross-income" class="input" value="0" min="0" step="1000">
                        </div>
                        <p class="help-text">Your total business income before expenses (Category B).</p>
                    </div>

                    <details class="details">
                        <summary>Other income sources (optional)</summary>
                        <div class="form-group">
                            <label for="divint-income">Dividends & Interest Income</label>
                            <div class="input-group">
                                <span class="input-group__prefix">€</span>
                                <input type="number" id="divint-income" class="input" value="0" min="0" step="100">
                            </div>
                            <p class="help-text">Taxed at 28% flat rate (Category E).</p>
                        </div>

                        <div class="form-group">
                            <label for="capgains-income">Capital Gains Income</label>
                            <div class="input-group">
                                <span class="input-group__prefix">€</span>
                                <input type="number" id="capgains-income" class="input" value="0" min="0" step="100">
                            </div>
                            <p class="help-text">Taxed at 28% flat rate (Category G).</p>
                        </div>
                    </details>
                </section>

                <!-- Expenses Tab -->
                <section id="expenses" class="tab-content">
                    <h2>Your Business Expenses</h2>

                    <div class="form-group">
                        <label for="total-business-expenses">Shared Business Expenses</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="total-business-expenses" class="input expense-input" value="25000" min="0" step="100">
                        </div>
                        <p class="help-text">Office, equipment, software, travel, etc. These apply to both setups.</p>
                    </div>

                    <div class="expense-split">
                        <div class="form-group">
                            <label for="admin-freelancer">Freelancer Admin Costs</label>
                            <div class="input-group">
                                <span class="input-group__prefix">€</span>
                                <input type="number" id="admin-freelancer" class="input expense-input" value="800" min="0" step="50">
                            </div>
                            <p class="help-text">Accountant, TOC fees for freelancer setup.</p>
                        </div>

                        <div class="form-group">
                            <label for="admin-transparent">Single-Member Company (LDA) Admin Costs</label>
                            <div class="input-group">
                                <span class="input-group__prefix">€</span>
                                <input type="number" id="admin-transparent" class="input expense-input" value="4800" min="0" step="50">
                            </div>
                            <p class="help-text">Accounting, compliance, legal fees for LLC.</p>
                        </div>
                    </div>

                    <label class="checkbox">
                        <input type="checkbox" id="use-suggested-admin">
                        <span>Use suggested admin costs based on typical market rates</span>
                    </label>

                    <div class="expense-summary">
                        <div class="expense-summary__item">
                            <span>Freelancer total expenses:</span>
                            <strong id="total-expenses-simp">€0.00</strong>
                        </div>
                        <div class="expense-summary__item">
                            <span>Single-Member Company (LDA) total expenses:</span>
                            <strong id="total-expenses-org">€0.00</strong>
                        </div>
                    </div>

                    <div id="expense-warning" class="alert alert--warning" style="display: none;"></div>
                    <div id="expense-error" class="alert alert--error" style="display: none;"></div>
                </section>

                <!-- Deductions Tab -->
                <section id="deductions" class="tab-content">
                    <h2>Personal Tax Deductions</h2>
                    
                    <p class="intro-text">These deductions reduce your final IRS bill. They apply to both setups.</p>

                    <div class="form-group">
                        <label for="health-expenses">Health Expenses</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="health-expenses" class="input" value="0" min="0" step="10">
                        </div>
                        <p class="help-text">15% deductible, max €<span id="health-deduction-display">0.00</span>.</p>
                    </div>

                    <div class="form-group">
                        <label for="education-expenses">Education Expenses</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="education-expenses" class="input" value="0" min="0" step="10">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="charitable-donations">Charitable Donations</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="charitable-donations" class="input" value="0" min="0" step="10">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="retirement-contributions">Retirement Contributions (PPR)</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="retirement-contributions" class="input" value="0" min="0" step="10">
                        </div>
                    </div>

                    <div class="deduction-summary">
                        <div class="deduction-summary__item">
                            <span>Personal allowance:</span>
                            <strong id="personal-allowance-display">€0.00</strong>
                        </div>
                        <div class="deduction-summary__item">
                            <span>Total deductions:</span>
                            <strong id="total-deductions-display">€0.00</strong>
                        </div>
                    </div>
                </section>

                <!-- Results Tab -->
                <section id="results" class="tab-content">
                    <div class="results-header">
                        <h2>Your Results</h2>
                        <div class="results-actions">
                            <button id="export-pdf-btn" class="btn btn--secondary" style="display: none;">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" style="margin-right: 0.5rem;">
                                    <path d="M8.5 1.5A1.5 1.5 0 0 0 7 0H4.5A1.5 1.5 0 0 0 3 1.5v13A1.5 1.5 0 0 0 4.5 16h7a1.5 1.5 0 0 0 1.5-1.5V4.621a1.5 1.5 0 0 0-.44-1.06L9.94 .939A1.5 1.5 0 0 0 8.878.5H8.5zM7 1.5a.5.5 0 0 1 .5-.5h1v2.5A.5.5 0 0 0 9 4h2.5v10a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 .5-.5H7z"/>
                                </svg>
                                Export to PDF
                            </button>
                            <button id="save-scenario-btn" class="btn btn--secondary" style="display: none;">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" style="margin-right: 0.5rem;">
                                    <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
                                </svg>
                                Save Scenario
                            </button>
                        </div>
                    </div>

                    <div id="results-zero-state" class="zero-state">
                        <p>👋 Enter your income and expenses to see which structure maximizes your take-home.</p>
                        <button class="btn btn--primary" data-tab-target="income">Get Started</button>
                    </div>

                    <div id="results-detail">
                        <!-- Quick Summary -->
                        <div class="summary-cards">
                            <div class="summary-card">
                                <div class="summary-card__label">
                                    <span>Freelancer Setup</span>
                                    <div class="radio-toggle">
                                        <label>
                                            <input type="radio" name="freelancer-basis" value="simplified" checked>
                                            <span>Simplified</span>
                                        </label>
                                        <label>
                                            <input type="radio" name="freelancer-basis" value="organized">
                                            <span>Organized</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="summary-card__value" id="summary-net-simp">€0.00</div>
                                <div class="summary-card__meta">
                                    <span id="summary-rate-simp">0.0%</span> take-home
                                </div>
                            </div>

                            <div class="summary-card summary-card--highlight">
                                <div class="summary-card__label">Single-Member Company (LDA)</div>
                                <div class="summary-card__value" id="summary-net-org">€0.00</div>
                                <div class="summary-card__meta">
                                    <span id="summary-rate-org">0.0%</span> take-home
                                </div>
                            </div>

                            <div class="summary-card summary-card--diff">
                                <div class="summary-card__label">Difference</div>
                                <div class="summary-card__value" id="summary-net-diff">€0.00</div>
                                <div class="summary-card__meta">
                                    <span id="summary-rate-diff">0.0%</span> rate difference
                                </div>
                            </div>
                        </div>

                        <!-- Winner Indicator -->
                        <div id="winner-banner" class="winner-banner" style="display: none;">
                            <div class="winner-banner__icon">🏆</div>
                            <div class="winner-banner__content">
                                <h3 class="winner-banner__title" id="winner-title">Best Option: Freelancer (Simplified)</h3>
                                <p class="winner-banner__subtitle" id="winner-subtitle">Maximizes your take-home income</p>
                                <div class="winner-banner__stats" id="winner-stats"></div>
                            </div>
                        </div>

                        <!-- Recommendation -->
                        <div class="recommendation">
                            <h3>Why This Structure Wins</h3>
                            <p id="recommendation-text"></p>
                            <div class="recommendation__details" id="recommendation-details" style="margin-top: 1rem;"></div>
                            <p class="recommendation__meta">
                                Breakeven point: <strong id="breakeven-expenses">€0.00</strong> in shared expenses
                            </p>
                        </div>

                        <!-- Detailed Breakdown -->
                        <div class="breakdown">
                            <div class="breakdown__col">
                                <h3 id="freelancer-results-title">Freelancer (Simplified) Results</h3>
                                <dl class="data-list">
                                    <dt>Gross income</dt>
                                    <dd id="simp-gross">€0.00</dd>
                                    
                                    <dt>Coefficient</dt>
                                    <dd id="simp-coefficient">75%</dd>
                                    
                                    <dt>Taxable income</dt>
                                    <dd id="simp-taxable">€0.00</dd>
                                    
                                    <dt>Total expenses</dt>
                                    <dd id="simp-expenses-total">€0.00</dd>
                                    
                                    <dt>Liability insurance</dt>
                                    <dd id="simp-liability">€0.00</dd>
                                    
                                    <dt>Tax deductions</dt>
                                    <dd id="simp-deducoes">€0.00</dd>
                                    
                                    <dt>IRS (income tax)</dt>
                                    <dd id="simp-irs">€0.00</dd>
                                    
                                    <dt>Social Security</dt>
                                    <dd id="simp-ss">€0.00</dd>
                                    
                                    <dt class="data-list__total">Net income</dt>
                                    <dd class="data-list__total" id="simp-net">€0.00</dd>
                                </dl>
                                <p id="simp-ss-note" class="help-text"></p>
                            </div>

                            <div class="breakdown__col">
                                <h3>Single-Member Company (LDA) Results</h3>
                                <dl class="data-list">
                                    <dt>Gross income</dt>
                                    <dd id="org-gross">€0.00</dd>
                                    
                                    <dt>Total expenses</dt>
                                    <dd id="org-expenses-total">€0.00</dd>
                                    
                                    <dt>Net business income</dt>
                                    <dd id="org-net-biz">€0.00</dd>
                                    
                                    <dt>Taxable income</dt>
                                    <dd id="org-taxable">€0.00</dd>
                                    
                                    <dt>Tax deductions</dt>
                                    <dd id="org-deducoes">€0.00</dd>
                                    
                                    <dt>IRS (income tax)</dt>
                                    <dd id="org-irs">€0.00</dd>
                                    
                                    <dt>Social Security</dt>
                                    <dd id="org-ss">€0.00</dd>
                                    
                                    <dt class="data-list__total">Net income</dt>
                                    <dd class="data-list__total" id="org-net">€0.00</dd>
                                </dl>
                                <p id="org-ss-note" class="help-text"></p>
                            </div>
                        </div>

                        <!-- Comparison Table -->
                        <details class="details" open>
                            <summary>Detailed comparison</summary>
                            <div class="comparison-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>Freelancer</th>
                                            <th>Single-Member Company</th>
                                            <th>Difference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Taxable income</td>
                                            <td id="comp-simple-taxable">€0.00</td>
                                            <td id="comp-organized-taxable">€0.00</td>
                                            <td id="comp-taxable-diff">€0.00</td>
                                        </tr>
                                        <tr>
                                            <td>Income tax (IRS)</td>
                                            <td id="comp-simple-tax">€0.00</td>
                                            <td id="comp-organized-tax">€0.00</td>
                                            <td id="comp-tax-diff">€0.00</td>
                                        </tr>
                                        <tr>
                                            <td>Social Security</td>
                                            <td id="comp-simple-ss">€0.00</td>
                                            <td id="comp-organized-ss">€0.00</td>
                                            <td id="comp-ss-diff">€0.00</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Net income</strong></td>
                                            <td id="comp-simple-net">€0.00</td>
                                            <td id="comp-organized-net">€0.00</td>
                                            <td id="comp-net-diff">€0.00</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </details>

                        <!-- Calculation Details -->
                        <details class="details">
                            <summary>View calculation steps</summary>
                            <div class="calculation-breakdown">
                                <div>
                                    <h4>Freelancer Calculation</h4>
                                    <ol id="calc-simp-steps" class="calc-steps"></ol>
                                    <h5>IRS Bracket Breakdown</h5>
                                    <ul id="calc-simp-irs-breakdown" class="calc-breakdown"></ul>
                                </div>
                                <div>
                                    <h4>Single-Member Company (LDA) Calculation</h4>
                                    <ol id="calc-org-steps" class="calc-steps"></ol>
                                    <h5>IRS Bracket Breakdown</h5>
                                    <ul id="calc-org-irs-breakdown" class="calc-breakdown"></ul>
                                </div>
                            </div>
                        </details>

                        <!-- Sanity Checks -->
                        <details class="details">
                            <summary>Input validation</summary>
                            <ul id="sanity-list" class="validation-list"></ul>
                        </details>

                        <!-- Inputs at a Glance -->
                        <div class="glance">
                            <h4>Your Current Setup</h4>
                            <div class="glance__grid">
                                <div class="glance__item">
                                    <span class="glance__label">NHR Status</span>
                                    <span class="glance__value" id="glance-nhr-status">Standard</span>
                                </div>
                                <div class="glance__item">
                                    <span class="glance__label">Activity Type</span>
                                    <span class="glance__value" id="glance-activity-value">High-value</span>
                                </div>
                                <div class="glance__item">
                                    <span class="glance__label">First-year Benefits</span>
                                    <div class="glance__value" id="glance-firstyear"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Methodology Tab -->
                <section id="methodology" class="tab-content">
                    <h2>Methodology & Tax Tables</h2>
                    <p class="intro-text">
                        This tool uses official 2025 Portuguese tax law and regulations. All calculations are transparent and verifiable.
                    </p>

                    <div class="methodology-grid">
                        <!-- IRS Progressive Brackets -->
                        <div class="methodology-section">
                            <h3>2025 IRS Progressive Tax Brackets</h3>
                            <p class="help-text">Applied to taxable income (after activity coefficient and deductions)</p>
                            <table class="tax-table">
                                <thead>
                                    <tr>
                                        <th>Income Bracket</th>
                                        <th>Tax Rate</th>
                                    </tr>
                                </thead>
                                <tbody id="irs-brackets-table">
                                    <tr><td>Up to €8,059</td><td>13.0%</td></tr>
                                    <tr><td>€8,060 - €12,160</td><td>16.5%</td></tr>
                                    <tr><td>€12,161 - €17,233</td><td>22.0%</td></tr>
                                    <tr><td>€17,234 - €22,306</td><td>25.0%</td></tr>
                                    <tr><td>€22,307 - €28,400</td><td>32.0%</td></tr>
                                    <tr><td>€28,401 - €41,629</td><td>35.5%</td></tr>
                                    <tr><td>€41,630 - €44,987</td><td>43.5%</td></tr>
                                    <tr><td>€44,988 - €83,696</td><td>45.0%</td></tr>
                                    <tr><td>Above €83,696</td><td>48.0%</td></tr>
                                </tbody>
                            </table>
                            <p class="help-text"><strong>Source:</strong> Portuguese Tax Authority (Orçamento do Estado 2025)</p>
                        </div>

                        <!-- Activity Coefficients -->
                        <div class="methodology-section">
                            <h3>Activity Coefficients</h3>
                            <p class="help-text">Percentage of gross income that remains taxable under simplified regime</p>
                            <div class="coefficient-cards">
                                <div class="coefficient-card">
                                    <div class="coefficient-card__value">75%</div>
                                    <div class="coefficient-card__label">High-Value Professions</div>
                                    <p class="help-text">Article 151 services (IT, consulting, design, etc.)</p>
                                    <p class="help-text"><strong>Deemed expenses: 25%</strong></p>
                                </div>
                                <div class="coefficient-card">
                                    <div class="coefficient-card__value">35%</div>
                                    <div class="coefficient-card__label">General Services</div>
                                    <p class="help-text">Other Category B professional services</p>
                                    <p class="help-text"><strong>Deemed expenses: 65%</strong></p>
                                </div>
                            </div>
                            <p class="help-text"><strong>Source:</strong> CIRS Article 31 & 151</p>
                        </div>

                        <!-- Social Security -->
                        <div class="methodology-section">
                            <h3>Social Security (Segurança Social)</h3>
                            <ul class="info-list">
                                <li><strong>Contribution Rate:</strong> 21.4% (unchanged from 2024)</li>
                                <li><strong>Relevant Income:</strong> 70% of gross income (or net business income for organized)</li>
                                <li><strong>Monthly Base Cap:</strong> €6,270 (12× IAS of €522.50)</li>
                                <li><strong>Maximum Monthly Contribution:</strong> €1,342 (21.4% of €6,270)</li>
                                <li><strong>First-Year Exemption:</strong> 12 rolling months available for new self-employed</li>
                            </ul>
                            <p class="help-text"><strong>Note:</strong> LDA managers typically contribute based on minimum declared salary (€522.50/month)</p>
                            <p class="help-text"><strong>Source:</strong> Segurança Social 2025 regulations</p>
                        </div>

                        <!-- Solidarity Tax -->
                        <div class="methodology-section">
                            <h3>Solidarity Tax (Taxa Extraordinária)</h3>
                            <p class="help-text">Additional tax on high incomes, applied to taxable income</p>
                            <table class="tax-table">
                                <thead>
                                    <tr>
                                        <th>Taxable Income Range</th>
                                        <th>Rate</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>€80,000 - €250,000</td><td>2.5%</td></tr>
                                    <tr><td>Above €250,000</td><td>5.0%</td></tr>
                                </tbody>
                            </table>
                            <p class="help-text"><strong>Example:</strong> Taxable income of €120,000</p>
                            <ul class="info-list">
                                <li>€80,000 - €120,000 = €40,000 × 2.5% = <strong>€1,000 solidarity tax</strong></li>
                            </ul>
                            <p class="help-text"><strong>Source:</strong> Lei n.º 82-B/2014 (OE 2015), maintained in 2025</p>
                        </div>

                        <!-- IRS Jovem -->
                        <div class="methodology-section">
                            <h3>IRS Jovem (Youth Tax Benefit)</h3>
                            <p class="help-text">Progressive income tax exemption for young professionals</p>
                            <table class="tax-table">
                                <thead>
                                    <tr>
                                        <th>Year</th>
                                        <th>Exemption</th>
                                        <th>Notes</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>Year 1</td><td>100%</td><td>First tax year after completing degree</td></tr>
                                    <tr><td>Year 2</td><td>75%</td><td>Second tax year</td></tr>
                                    <tr><td>Year 3</td><td>50%</td><td>Third tax year</td></tr>
                                    <tr><td>Year 4</td><td>50%</td><td>Fourth tax year</td></tr>
                                    <tr><td>Year 5</td><td>25%</td><td>Fifth tax year</td></tr>
                                    <tr><td>Years 6-10</td><td>0%</td><td>No exemption (if income continues)</td></tr>
                                </tbody>
                            </table>
                            <p class="help-text"><strong>Eligibility:</strong> Under 35 years old, completed higher education (bachelor's degree or higher), Portuguese tax resident</p>
                            <p class="help-text"><strong>Income Cap:</strong> Up to €28,737.50 per year (exemption applies to this amount)</p>
                            <p class="help-text"><strong>Combination:</strong> Can be combined with NHR/IFICI 20% flat rate</p>
                            <p class="help-text"><strong>Source:</strong> CIRS Article 12-A (introduced 2020, updated 2023)</p>
                        </div>

                        <!-- NHR / IFICI -->
                        <div class="methodology-section">
                            <h3>NHR / IFICI (20% Flat Rate)</h3>
                            <p class="help-text">Special tax regime for qualifying residents and activities</p>
                            <ul class="info-list">
                                <li><strong>Original NHR:</strong> Granted before 2024, 10-year benefit</li>
                                <li><strong>NHR 2.0 / IFICI:</strong> Granted from 2024+, requires IFICI status</li>
                                <li><strong>Flat Rate:</strong> 20% on professional income (Category B)</li>
                                <li><strong>Eligible Activities:</strong> High-value professions (Article 151) primarily</li>
                                <li><strong>Replaces:</strong> Progressive brackets (13%-48%) with flat 20%</li>
                            </ul>
                            <p class="help-text"><strong>Note:</strong> Solidarity tax still applies if taxable income exceeds €80,000</p>
                            <p class="help-text"><strong>Source:</strong> CIRS Article 72 (NHR), Decree-Law 249/2023 (IFICI)</p>
                        </div>

                        <!-- Personal Deductions -->
                        <div class="methodology-section">
                            <h3>Personal Tax Deductions</h3>
                            <ul class="info-list">
                                <li><strong>Personal Allowance:</strong> €4,462.15 (automatic, 8.54× IAS)</li>
                                <li><strong>Health Expenses:</strong> 15% deductible, max €1,000</li>
                                <li><strong>Education Expenses:</strong> 30% deductible, max €800</li>
                                <li><strong>Dependent Allowance:</strong> €600 per dependent</li>
                            </ul>
                            <p class="help-text"><strong>Source:</strong> CIRS Article 78 & 79</p>
                        </div>

                        <!-- Compliance Costs -->
                        <div class="methodology-section">
                            <h3>Typical Compliance Costs (Annual)</h3>
                            <p class="help-text">Estimated accounting and administrative expenses</p>
                            <table class="tax-table">
                                <thead>
                                    <tr>
                                        <th>Structure</th>
                                        <th>Typical Range</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td>Freelancer (Simplified)</td><td>€360 - €1,200</td></tr>
                                    <tr><td>Freelancer (Organized)</td><td>€2,400 - €3,600</td></tr>
                                    <tr><td>Single-Member Company (LDA)</td><td>€3,650 - €8,000</td></tr>
                                </tbody>
                            </table>
                            <p class="help-text"><strong>LDA Additional Costs:</strong> Minimum manager salary (~€6,270/year) + social security (~€2,179/year) typically required</p>
                            <p class="help-text"><strong>Note:</strong> Actual costs vary by accountant (TOC) and complexity</p>
                        </div>

                        <!-- Calculation Method -->
                        <div class="methodology-section methodology-section--full">
                            <h3>How We Calculate</h3>
                            <div class="calculation-flow">
                                <div class="flow-step">
                                    <h4>1. Determine Taxable Income</h4>
                                    <ul class="info-list">
                                        <li><strong>Simplified:</strong> Gross Income × Coefficient (75% or 35%)</li>
                                        <li><strong>Organized:</strong> Gross Income - Real Expenses</li>
                                        <li><strong>LDA:</strong> Gross Income - Real Expenses</li>
                                    </ul>
                                </div>
                                <div class="flow-step">
                                    <h4>2. Calculate Income Tax (IRS)</h4>
                                    <ul class="info-list">
                                        <li><strong>Progressive:</strong> Apply 2025 tax brackets cumulatively</li>
                                        <li><strong>NHR/IFICI:</strong> Apply 20% flat rate</li>
                                        <li><strong>Add Solidarity Tax:</strong> If taxable income > €80,000</li>
                                        <li><strong>Subtract Deductions:</strong> Personal allowance + expenses</li>
                                        <li><strong>Apply Benefits:</strong> 50% first-year reduction, IRS Jovem exemption</li>
                                    </ul>
                                </div>
                                <div class="flow-step">
                                    <h4>3. Calculate Social Security</h4>
                                    <ul class="info-list">
                                        <li><strong>Relevant Income:</strong> 70% of gross (simplified) or net business income (organized)</li>
                                        <li><strong>Quarterly Relevant Income:</strong> ÷ 4</li>
                                        <li><strong>Monthly Base:</strong> Quarterly ÷ 3, capped at €6,270</li>
                                        <li><strong>Monthly Contribution:</strong> Base × 21.4%</li>
                                        <li><strong>Annual:</strong> Monthly × 12 (or €0 if first-year exemption)</li>
                                    </ul>
                                </div>
                                <div class="flow-step">
                                    <h4>4. Calculate Net Income</h4>
                                    <ul class="info-list">
                                        <li><strong>Formula:</strong> Gross Income - Expenses - IRS - Social Security</li>
                                        <li><strong>Take-Home %:</strong> (Net Income ÷ Gross Income) × 100</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="disclaimer-box">
                        <h4>⚖️ Important Disclaimers</h4>
                        <ul class="info-list">
                            <li>This tool provides <strong>estimates</strong> based on 2025 Portuguese tax law and typical scenarios.</li>
                            <li>Results are for <strong>informational purposes only</strong> and do not constitute financial, legal, or tax advice.</li>
                            <li><strong>Individual circumstances vary</strong>: Your actual tax situation may differ based on residency status, bilateral treaties, specific deductions, etc.</li>
                            <li><strong>Professional consultation recommended</strong>: Always consult a certified Portuguese accountant (TOC) or tax advisor before making structural decisions.</li>
                            <li><strong>Regulations change</strong>: Tax laws are updated annually. Verify current rates with official sources.</li>
                            <li><strong>Not a tax filing tool</strong>: This planner helps you choose a structure, not file taxes or handle compliance.</li>
                        </ul>
                    </div>

                    <div class="sources-section">
                        <h4>📚 Official Sources</h4>
                        <ul class="info-list">
                            <li><strong>Tax Authority (AT):</strong> <a href="https://www.portaldasfinancas.gov.pt" target="_blank" rel="noopener">portaldasfinancas.gov.pt</a></li>
                            <li><strong>Social Security:</strong> <a href="https://www.seg-social.pt" target="_blank" rel="noopener">seg-social.pt</a></li>
                            <li><strong>IRS Code (CIRS):</strong> <a href="https://info.portaldasfinancas.gov.pt/pt/informacao_fiscal/codigos_tributarios/cirs_rep/" target="_blank" rel="noopener">CIRS Full Text</a></li>
                            <li><strong>2025 State Budget:</strong> Orçamento do Estado 2025 (Official Gazette)</li>
                        </ul>
                    </div>
                </section>

            </div>
        </main>

        <footer class="footer">
            <div class="container">
                <p id="app-version" class="footer__version"></p>
                <p class="footer__disclaimer">
                    <strong>Disclaimer:</strong> This is a structure optimization planner, not a tax filing tool. Results are estimates based on 2025 Portuguese tax law for informational purposes only. 
                    Individual circumstances vary—consult a certified Portuguese accountant (TOC) or tax advisor before making structural decisions.
                </p>
            </div>
        </footer>
    </div>

    <script src="logic.js"></script>
    <script src="app.js"></script>
</body>
</html>
