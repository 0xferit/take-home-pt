<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TakeHome PT – Tax Planning for Self-Employed Professionals in Portugal</title>
    <meta name="description" content="Optimize your tax setup in Portugal. Compare Freelancer vs Transparent LLC to maximize your take-home income.">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="container">
                <h1 class="header__title">TakeHome PT</h1>
                <p class="header__subtitle">Tax optimization for self-employed professionals in Portugal</p>
            </div>
        </header>

        <nav class="tabs">
            <div class="container">
                <button class="tab active" data-tab="setup">Setup</button>
                <button class="tab" data-tab="income">Income</button>
                <button class="tab" data-tab="expenses">Expenses</button>
                <button class="tab" data-tab="deductions">Deductions</button>
                <button class="tab" data-tab="results">Results</button>
            </div>
        </nav>

        <main class="main">
            <div class="container">
                
                <!-- Setup Tab -->
                <section id="setup" class="tab-content active">
                    <h2>Your Profile & Tax Status</h2>
                    
                    <div class="form-group">
                        <label for="nhr-status">NHR / Tax Status</label>
                        <select id="nhr-status" class="input">
                            <option value="standard">Standard progressive rates</option>
                            <option value="original_nhr">Original NHR (20% flat rate)</option>
                            <option value="nhr_2_ifici">NHR 2.0 / IFICI (20% flat rate)</option>
                        </select>
                        <p id="nhr-status-note" class="help-text"></p>
                    </div>

                    <div class="form-group">
                        <label>Activity Type</label>
                        <div class="radio-group">
                            <label class="radio-card" data-activity-option="services_high_value">
                                <input type="radio" name="activity-profile" value="services_high_value" checked>
                                <div class="radio-card__content">
                                    <strong>High-value professions</strong>
                                    <span>Article 151 services – 75% taxable, 25% deemed expenses</span>
                                </div>
                            </label>
                            <label class="radio-card" data-activity-option="services_general">
                                <input type="radio" name="activity-profile" value="services_general">
                                <div class="radio-card__content">
                                    <strong>General professional services</strong>
                                    <span>Category B services – 35% taxable, 65% deemed expenses</span>
                                </div>
                            </label>
                        </div>
                        <details class="details">
                            <summary>What are high-value professions?</summary>
                            <p>High-value professions include software development, consulting, design, and other technical services listed in Article 151 of the Portuguese tax code.</p>
                            <p><strong>CAE Codes:</strong> <span id="activity-summary-codes"></span></p>
                        </details>
                    </div>

                    <div class="form-group">
                        <label for="activity-code">CAE Activity Code (optional)</label>
                        <input 
                            type="text" 
                            id="activity-code" 
                            class="input" 
                            list="activity-code-options"
                            placeholder="e.g., 62010"
                            maxlength="5">
                        <datalist id="activity-code-options"></datalist>
                        <p class="help-text">Enter your 5-digit CAE code to auto-select the correct activity type.</p>
                    </div>

                    <details class="details">
                        <summary>First-year benefits</summary>
                        <div class="checkbox-group">
                            <label class="checkbox">
                                <input type="checkbox" id="firstyear-ss-exempt">
                                <span>Social Security exemption (first 12 months)</span>
                            </label>
                            <label class="checkbox">
                                <input type="checkbox" id="firstyear-irs-50">
                                <span>50% IRS reduction (first tax year)</span>
                            </label>
                        </div>
                    </details>
                </section>

                <!-- Income Tab -->
                <section id="income" class="tab-content">
                    <h2>Your Income</h2>
                    
                    <div class="form-group">
                        <label for="gross-income">Annual Gross Income from Services</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="gross-income" class="input" value="0" min="0" step="1000">
                        </div>
                        <p class="help-text">Your total business income before expenses (Category B).</p>
                    </div>

                    <details class="details">
                        <summary>Other income sources (optional)</summary>
                        <div class="form-group">
                            <label for="divint-income">Dividends & Interest Income</label>
                            <div class="input-group">
                                <span class="input-group__prefix">€</span>
                                <input type="number" id="divint-income" class="input" value="0" min="0" step="100">
                            </div>
                            <p class="help-text">Taxed at 28% flat rate (Category E).</p>
                        </div>

                        <div class="form-group">
                            <label for="capgains-income">Capital Gains Income</label>
                            <div class="input-group">
                                <span class="input-group__prefix">€</span>
                                <input type="number" id="capgains-income" class="input" value="0" min="0" step="100">
                            </div>
                            <p class="help-text">Taxed at 28% flat rate (Category G).</p>
                        </div>
                    </details>
                </section>

                <!-- Expenses Tab -->
                <section id="expenses" class="tab-content">
                    <h2>Your Business Expenses</h2>

                    <div class="form-group">
                        <label for="total-business-expenses">Shared Business Expenses</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="total-business-expenses" class="input expense-input" value="25000" min="0" step="100">
                        </div>
                        <p class="help-text">Office, equipment, software, travel, etc. These apply to both setups.</p>
                    </div>

                    <div class="expense-split">
                        <div class="form-group">
                            <label for="admin-freelancer">Freelancer Admin Costs</label>
                            <div class="input-group">
                                <span class="input-group__prefix">€</span>
                                <input type="number" id="admin-freelancer" class="input expense-input" value="800" min="0" step="50">
                            </div>
                            <p class="help-text">Accountant, TOC fees for freelancer setup.</p>
                        </div>

                        <div class="form-group">
                            <label for="admin-transparent">Transparent LLC Admin Costs</label>
                            <div class="input-group">
                                <span class="input-group__prefix">€</span>
                                <input type="number" id="admin-transparent" class="input expense-input" value="4800" min="0" step="50">
                            </div>
                            <p class="help-text">Accounting, compliance, legal fees for LLC.</p>
                        </div>
                    </div>

                    <label class="checkbox">
                        <input type="checkbox" id="use-suggested-admin">
                        <span>Use suggested admin costs based on typical market rates</span>
                    </label>

                    <div class="expense-summary">
                        <div class="expense-summary__item">
                            <span>Freelancer total expenses:</span>
                            <strong id="total-expenses-simp">€0.00</strong>
                        </div>
                        <div class="expense-summary__item">
                            <span>Transparent LLC total expenses:</span>
                            <strong id="total-expenses-org">€0.00</strong>
                        </div>
                    </div>

                    <div id="expense-warning" class="alert alert--warning" style="display: none;"></div>
                    <div id="expense-error" class="alert alert--error" style="display: none;"></div>
                </section>

                <!-- Deductions Tab -->
                <section id="deductions" class="tab-content">
                    <h2>Personal Tax Deductions</h2>
                    
                    <p class="intro-text">These deductions reduce your final IRS bill. They apply to both setups.</p>

                    <div class="form-group">
                        <label for="health-expenses">Health Expenses</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="health-expenses" class="input" value="0" min="0" step="10">
                        </div>
                        <p class="help-text">15% deductible, max €<span id="health-deduction-display">0.00</span>.</p>
                    </div>

                    <div class="form-group">
                        <label for="education-expenses">Education Expenses</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="education-expenses" class="input" value="0" min="0" step="10">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="charitable-donations">Charitable Donations</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="charitable-donations" class="input" value="0" min="0" step="10">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="retirement-contributions">Retirement Contributions (PPR)</label>
                        <div class="input-group">
                            <span class="input-group__prefix">€</span>
                            <input type="number" id="retirement-contributions" class="input" value="0" min="0" step="10">
                        </div>
                    </div>

                    <div class="deduction-summary">
                        <div class="deduction-summary__item">
                            <span>Personal allowance:</span>
                            <strong id="personal-allowance-display">€0.00</strong>
                        </div>
                        <div class="deduction-summary__item">
                            <span>Total deductions:</span>
                            <strong id="total-deductions-display">€0.00</strong>
                        </div>
                    </div>
                </section>

                <!-- Results Tab -->
                <section id="results" class="tab-content">
                    <h2>Your Results</h2>

                    <div id="results-zero-state" class="zero-state">
                        <p>👋 Enter your income and expenses to see your personalized tax comparison.</p>
                        <button class="btn btn--primary" data-tab-target="income">Get Started</button>
                    </div>

                    <div id="results-detail">
                        <!-- Quick Summary -->
                        <div class="summary-cards">
                            <div class="summary-card">
                                <div class="summary-card__label">
                                    <span>Freelancer Setup</span>
                                    <div class="radio-toggle">
                                        <label>
                                            <input type="radio" name="freelancer-basis" value="simplified" checked>
                                            <span>Simplified</span>
                                        </label>
                                        <label>
                                            <input type="radio" name="freelancer-basis" value="organized">
                                            <span>Organized</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="summary-card__value" id="summary-net-simp">€0.00</div>
                                <div class="summary-card__meta">
                                    <span id="summary-rate-simp">0.0%</span> take-home
                                </div>
                            </div>

                            <div class="summary-card summary-card--highlight">
                                <div class="summary-card__label">Transparent LLC</div>
                                <div class="summary-card__value" id="summary-net-org">€0.00</div>
                                <div class="summary-card__meta">
                                    <span id="summary-rate-org">0.0%</span> take-home
                                </div>
                            </div>

                            <div class="summary-card summary-card--diff">
                                <div class="summary-card__label">Difference</div>
                                <div class="summary-card__value" id="summary-net-diff">€0.00</div>
                                <div class="summary-card__meta">
                                    <span id="summary-rate-diff">0.0%</span> rate difference
                                </div>
                            </div>
                        </div>

                        <!-- Recommendation -->
                        <div class="recommendation">
                            <h3>Recommendation</h3>
                            <p id="recommendation-text"></p>
                            <p class="recommendation__meta">
                                Break-even point: <strong id="breakeven-expenses">€0.00</strong> in shared expenses
                            </p>
                        </div>

                        <!-- Detailed Breakdown -->
                        <div class="breakdown">
                            <div class="breakdown__col">
                                <h3 id="freelancer-results-title">Freelancer (Simplified) Results</h3>
                                <dl class="data-list">
                                    <dt>Gross income</dt>
                                    <dd id="simp-gross">€0.00</dd>
                                    
                                    <dt>Coefficient</dt>
                                    <dd id="simp-coefficient">75%</dd>
                                    
                                    <dt>Taxable income</dt>
                                    <dd id="simp-taxable">€0.00</dd>
                                    
                                    <dt>Total expenses</dt>
                                    <dd id="simp-expenses-total">€0.00</dd>
                                    
                                    <dt>Liability insurance</dt>
                                    <dd id="simp-liability">€0.00</dd>
                                    
                                    <dt>Tax deductions</dt>
                                    <dd id="simp-deducoes">€0.00</dd>
                                    
                                    <dt>IRS (income tax)</dt>
                                    <dd id="simp-irs">€0.00</dd>
                                    
                                    <dt>Social Security</dt>
                                    <dd id="simp-ss">€0.00</dd>
                                    
                                    <dt class="data-list__total">Net income</dt>
                                    <dd class="data-list__total" id="simp-net">€0.00</dd>
                                </dl>
                                <p id="simp-ss-note" class="help-text"></p>
                            </div>

                            <div class="breakdown__col">
                                <h3>Transparent LLC Results</h3>
                                <dl class="data-list">
                                    <dt>Gross income</dt>
                                    <dd id="org-gross">€0.00</dd>
                                    
                                    <dt>Total expenses</dt>
                                    <dd id="org-expenses-total">€0.00</dd>
                                    
                                    <dt>Net business income</dt>
                                    <dd id="org-net-biz">€0.00</dd>
                                    
                                    <dt>Taxable income</dt>
                                    <dd id="org-taxable">€0.00</dd>
                                    
                                    <dt>Tax deductions</dt>
                                    <dd id="org-deducoes">€0.00</dd>
                                    
                                    <dt>IRS (income tax)</dt>
                                    <dd id="org-irs">€0.00</dd>
                                    
                                    <dt>Social Security</dt>
                                    <dd id="org-ss">€0.00</dd>
                                    
                                    <dt class="data-list__total">Net income</dt>
                                    <dd class="data-list__total" id="org-net">€0.00</dd>
                                </dl>
                                <p id="org-ss-note" class="help-text"></p>
                            </div>
                        </div>

                        <!-- Comparison Table -->
                        <details class="details" open>
                            <summary>Detailed comparison</summary>
                            <div class="comparison-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>Freelancer</th>
                                            <th>Transparent LLC</th>
                                            <th>Difference</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Taxable income</td>
                                            <td id="comp-simple-taxable">€0.00</td>
                                            <td id="comp-organized-taxable">€0.00</td>
                                            <td id="comp-taxable-diff">€0.00</td>
                                        </tr>
                                        <tr>
                                            <td>Income tax (IRS)</td>
                                            <td id="comp-simple-tax">€0.00</td>
                                            <td id="comp-organized-tax">€0.00</td>
                                            <td id="comp-tax-diff">€0.00</td>
                                        </tr>
                                        <tr>
                                            <td>Social Security</td>
                                            <td id="comp-simple-ss">€0.00</td>
                                            <td id="comp-organized-ss">€0.00</td>
                                            <td id="comp-ss-diff">€0.00</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Net income</strong></td>
                                            <td id="comp-simple-net">€0.00</td>
                                            <td id="comp-organized-net">€0.00</td>
                                            <td id="comp-net-diff">€0.00</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </details>

                        <!-- Calculation Details -->
                        <details class="details">
                            <summary>View calculation steps</summary>
                            <div class="calculation-breakdown">
                                <div>
                                    <h4>Freelancer Calculation</h4>
                                    <ol id="calc-simp-steps" class="calc-steps"></ol>
                                    <h5>IRS Bracket Breakdown</h5>
                                    <ul id="calc-simp-irs-breakdown" class="calc-breakdown"></ul>
                                </div>
                                <div>
                                    <h4>Transparent LLC Calculation</h4>
                                    <ol id="calc-org-steps" class="calc-steps"></ol>
                                    <h5>IRS Bracket Breakdown</h5>
                                    <ul id="calc-org-irs-breakdown" class="calc-breakdown"></ul>
                                </div>
                            </div>
                        </details>

                        <!-- Sanity Checks -->
                        <details class="details">
                            <summary>Input validation</summary>
                            <ul id="sanity-list" class="validation-list"></ul>
                        </details>

                        <!-- Inputs at a Glance -->
                        <div class="glance">
                            <h4>Your Current Setup</h4>
                            <div class="glance__grid">
                                <div class="glance__item">
                                    <span class="glance__label">NHR Status</span>
                                    <span class="glance__value" id="glance-nhr-status">Standard</span>
                                </div>
                                <div class="glance__item">
                                    <span class="glance__label">Activity Type</span>
                                    <span class="glance__value" id="glance-activity-value">High-value</span>
                                </div>
                                <div class="glance__item">
                                    <span class="glance__label">First-year Benefits</span>
                                    <div class="glance__value" id="glance-firstyear"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

            </div>
        </main>

        <footer class="footer">
            <div class="container">
                <p id="app-version" class="footer__version"></p>
                <p class="footer__disclaimer">
                    <strong>Disclaimer:</strong> This calculator provides estimates based on 2025 Portuguese tax law. 
                    Results are for informational purposes only. Consult a qualified tax professional before making financial decisions.
                </p>
            </div>
        </footer>
    </div>

    <script src="logic.js"></script>
    <script src="app.js"></script>
</body>
</html>
